<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Metrics](#metrics)
    -   [sendEvent](#sendevent)

## Metrics

Class that represents a metrics event broker. Events are sent to Google
Analytics if the `tid` parameter is set. Events are sent to Mozilla's
data pipeline via the Test Pilot add-on. No metrics code changes are
needed when the experiment is added to or removed from Test Pilot.

**Parameters**

-   `$0` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
    -   `$0.id` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** addon ID, e.g. '@testpilot-addon'. See <https://mdn.io/add_on_id>.
    -   `$0.version` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** addon version, e.g. '1.0.2'.
    -   `$0.uid` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** unique identifier for a specific instance of an addon.
        Used as Google Analytics user ID.
    -   `$0.tid` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** Google Analytics tracking ID. Optional, but required
        to send events to Google Analytics.
    -   `$0.type` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** addon type. one of: 'webextension',
        'sdk', 'bootstrapped'. (optional, default `webextension`)
    -   `$0.debug` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?** if true, enables logging. Note that this
        value can be changed on a running instance, by modifying its `debug` property. (optional, default `false`)


-   Throws **[SyntaxError](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError)** If the required properties are missing, or if the
    'type' property is unrecognized.
-   Throws **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** if initializing the transports fails.

### sendEvent

Sends an event to the Mozilla data pipeline (and Google Analytics, if
a `tid` was passed to the constructor). Note: to avoid breaking callers,
if sending the event fails, no Errors will be thrown. Instead, the message
will be silently dropped, and, if debug mode is enabled, an error will be
logged to the Browser Console.

If you want to pass extra fields to GA, or use a GA hit type other than
`Event`, you can transform the output data object yourself using the
`transform` parameter. You will need to add Custom Dimensions to GA for any
extra fields: <https://support.google.com/analytics/answer/2709828>. Note
that, by convention, the `variant` argument is mapped to the first Custom
Dimension (`cd1`) when constructing the GA Event hit.

Note: the data object format is currently different for each experiment,
and should be defined based on the result of conversations with the Mozilla
data team.

A suggested default format is:

**Parameters**

-   `$0.method` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** What is happening? e.g. `click`
-   `$0.object` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** What is being affected? e.g. `home-button-1`
-   `$0.category` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** If you want to add a category
    for easy reporting later. e.g. `mainmenu` (optional, default `interactions`)
-   `$0.variant` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** An identifying string if you're running
    different variants. e.g. `cohort-A`
-   `transform` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)?** Transform function used to alter the
    parameters sent to GA. The `transform` function signature is
    `transform(input, output)`, where `input` is the object passed to
    `sendEvent` (excluding `transform`), and `output` is the default GA
    object generated by the `_gaTransform` method. The `transform` function
    should return an object whose keys are GA Measurement Protocol parameters.
    The returned object will be form encoded and sent to GA.
